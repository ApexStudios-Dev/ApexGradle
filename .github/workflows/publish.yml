name: Publish

on:
  workflow_dispatch:
  push:
    branches: [ "**/main" ]
    paths: [ "**/src/**" ]

jobs:
  generate-vars:
    name: Generate Vars
    uses: ApexStudios-Dev/.github/.github/workflows/_generate-vars.yml@master
    secrets: inherit

  publish:
    name: Publish
    uses: ApexStudios-Dev/.github/.github/workflows/_publish-maven.yml@master
    needs: generate-vars
    secrets: inherit
    with:
      java-version: 21
      java-vendor: temurin
      version: ${{ needs.generate-vars.outputs.version }}
      publish-task: ':publishAllPublicationsToApexStudios-ReleasesRepository'
